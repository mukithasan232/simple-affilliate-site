{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/tushar/Documents/02_Professional/Practice%20projects/simple%20affilliate%20site/src/app/api/admin/scrape/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { JSDOM } from \"jsdom\";\n\nexport async function POST(req: Request) {\n    try {\n        const { url } = await req.json();\n\n        if (!url || !url.includes(\"amazon.com\")) {\n            return NextResponse.json({ error: \"Please provide a valid Amazon URL\" }, { status: 400 });\n        }\n\n        const response = await fetch(url, {\n            headers: {\n                \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36\",\n                \"Accept-Language\": \"en-US,en;q=0.9\",\n            },\n        });\n\n        const html = await response.text();\n        const dom = new JSDOM(html);\n        const document = dom.window.document;\n\n        // Helper to get text by selector\n        const getText = (selector: string) => document.querySelector(selector)?.textContent?.trim() || \"\";\n\n        // Extracting Data\n        const title = getText(\"#productTitle\");\n        const priceRaw = getText(\".a-price .a-offscreen\") || getText(\"#priceblock_ourprice\") || getText(\"#priceblock_dealprice\");\n        const oldPriceRaw = getText(\".a-price.a-text-price span[aria-hidden='true']\");\n        const price = parseFloat(priceRaw.replace(/[^0-9.]/g, \"\")) || 0;\n        const oldPrice = parseFloat(oldPriceRaw.replace(/[^0-9.]/g, \"\")) || null;\n        const ratingRaw = getText(\"#acrCustomerReviewText\").split(\" \")[0];\n        const rating = parseFloat(getText(\".a-icon-alt\").split(\" \")[0]) || 0;\n\n        // Image URL - usually in a script or a specific img tag\n        const imgTag = document.querySelector(\"#landingImage\") as HTMLImageElement;\n        const image = imgTag?.src || \"\";\n\n        // Features (Bullet points)\n        const features = Array.from(document.querySelectorAll(\"#feature-bullets li span\"))\n            .map(span => span.textContent?.trim())\n            .filter(text => text && !text.toLowerCase().includes(\"see more\"))\n            .slice(0, 5);\n\n        const scrapedData = {\n            title,\n            price,\n            oldPrice,\n            rating,\n            image,\n            features,\n            link: url,\n            category: \"General\", // Default category\n            featured: false,\n            badge: \"\",\n            pros: [\"High quality\", \"Reliable performance\"], // AI placeholders\n            cons: [\"May be expensive for some\", \"Limited stock\"],\n            reviewSummary: `A comprehensive look at the ${title}. It offers great value and performance for its category.`,\n            faqs: [\n                { q: \"Is it worth the price?\", a: \"Based on our analysis, yes it offers solid value.\" }\n            ]\n        };\n\n        return NextResponse.json(scrapedData);\n    } catch (error) {\n        console.error(\"Scrape Error:\", error);\n        return NextResponse.json({ error: \"Failed to scrape product data. Amazon might be blocking the request.\" }, { status: 500 });\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAY;IACnC,IAAI;QACA,MAAM,EAAE,GAAG,EAAE,GAAG,MAAM,IAAI,IAAI;QAE9B,IAAI,CAAC,OAAO,CAAC,IAAI,QAAQ,CAAC,eAAe;YACrC,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAoC,GAAG;gBAAE,QAAQ;YAAI;QAC3F;QAEA,MAAM,WAAW,MAAM,MAAM,KAAK;YAC9B,SAAS;gBACL,cAAc;gBACd,mBAAmB;YACvB;QACJ;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,MAAM,MAAM,IAAI,wJAAK,CAAC;QACtB,MAAM,WAAW,IAAI,MAAM,CAAC,QAAQ;QAEpC,iCAAiC;QACjC,MAAM,UAAU,CAAC,WAAqB,SAAS,aAAa,CAAC,WAAW,aAAa,UAAU;QAE/F,kBAAkB;QAClB,MAAM,QAAQ,QAAQ;QACtB,MAAM,WAAW,QAAQ,4BAA4B,QAAQ,2BAA2B,QAAQ;QAChG,MAAM,cAAc,QAAQ;QAC5B,MAAM,QAAQ,WAAW,SAAS,OAAO,CAAC,YAAY,QAAQ;QAC9D,MAAM,WAAW,WAAW,YAAY,OAAO,CAAC,YAAY,QAAQ;QACpE,MAAM,YAAY,QAAQ,0BAA0B,KAAK,CAAC,IAAI,CAAC,EAAE;QACjE,MAAM,SAAS,WAAW,QAAQ,eAAe,KAAK,CAAC,IAAI,CAAC,EAAE,KAAK;QAEnE,wDAAwD;QACxD,MAAM,SAAS,SAAS,aAAa,CAAC;QACtC,MAAM,QAAQ,QAAQ,OAAO;QAE7B,2BAA2B;QAC3B,MAAM,WAAW,MAAM,IAAI,CAAC,SAAS,gBAAgB,CAAC,6BACjD,GAAG,CAAC,CAAA,OAAQ,KAAK,WAAW,EAAE,QAC9B,MAAM,CAAC,CAAA,OAAQ,QAAQ,CAAC,KAAK,WAAW,GAAG,QAAQ,CAAC,aACpD,KAAK,CAAC,GAAG;QAEd,MAAM,cAAc;YAChB;YACA;YACA;YACA;YACA;YACA;YACA,MAAM;YACN,UAAU;YACV,UAAU;YACV,OAAO;YACP,MAAM;gBAAC;gBAAgB;aAAuB;YAC9C,MAAM;gBAAC;gBAA6B;aAAgB;YACpD,eAAe,CAAC,4BAA4B,EAAE,MAAM,yDAAyD,CAAC;YAC9G,MAAM;gBACF;oBAAE,GAAG;oBAA0B,GAAG;gBAAoD;aACzF;QACL;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAuE,GAAG;YAAE,QAAQ;QAAI;IAC9H;AACJ"}}]
}